<!-- REPLACE WHOLE FILE: /store/thoi-trang.html -->
<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Thời trang | MXD</title>
  <meta name="description" content="Thời trang MXD: bền–chuẩn–dễ phối cho công sở, đi công trình và cuối tuần. Lưới sản phẩm, deal hôm nay, FAQ chọn size/chất liệu.">
  <link rel="canonical" href="https://mxd210.github.io/store/thoi-trang.html"/>
  <meta name="robots" content="index,follow"/>

  <!-- OG -->
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="Thời trang | MXD"/>
  <meta property="og:description" content="Danh mục thời trang tổng hợp: công sở, basic, bảo hộ, thể thao; deal hôm nay & FAQ chọn nhanh."/>
  <meta property="og:url" content="https://mxd210.github.io/store/thoi-trang.html"/>
  <meta property="og:image" content="https://mxd210.github.io/assets/img/categories/thoi-trang.webp"/>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/site.css"/>

  <!-- GA4 TRƯỚC affiliate (chuẩn MXD) -->
  <script defer src="/assets/analytics.js"></script>
  <script defer src="/assets/mxd-affiliate.js"></script>
</head>
<body>
  <nav class="breadcrumb"><a href="/">Trang chủ</a> › <a href="/store.html">Cửa hàng</a> › Thời trang</nav>
  <h1>Thời trang</h1>

  <!-- HERO: intro ngắn + CTA -->
  <section class="category-hero">
    <p>Thời trang ở MXD xoay quanh ba tiêu chí **bền – chuẩn – dễ phối** cho khí hậu nóng ẩm: thấm hút, nhanh khô, dễ layer từ phòng lạnh ra ngoài trời. Chọn đúng chất liệu và form, bạn “mặc nhanh mà vẫn đúng”.</p>
    <p class="cta-row">
      <a class="btn" href="#deals">Deal hôm nay</a>
      <a class="btn" href="#faq-size">Bảng size nhanh</a>
    </p>
  </section>

  <!-- FILTER CHIP -->
  <div class="filter-row" data-subnav="thoi-trang">
    <a class="btn" href="/store/thoi-trang.html">Tất cả</a>
    <a class="btn" href="/store/thoi-trang-nam.html">Thời trang nam</a>
    <a class="btn" href="/store/thoi-trang-nu.html">Thời trang nữ</a>
    <a class="btn" href="/store/tre-em.html">Trẻ em</a>
    <a class="btn" href="/store/thoi-trang-thu-dong.html">Thu đông</a>
  </div>

  <!-- LƯỚI SẢN PHẨM (đặt sớm để tăng CTR) -->
  <section id="product-grid"
           class="product-grid"
           data-category="thoi-trang"
           data-alias="thoi-trang,thoi-trang-nam,thoi-trang-nu,tre-em,thoi-trang-thu-dong">
  </section>

  <!-- DEAL HÔM NAY -->
  <section id="deals" class="product-deals">
    <h2>Deal hôm nay</h2>
    <div id="deals-grid" class="product-grid compact"></div>
  </section>

  <!-- FAQ NGẮN GỌN -->
  <section class="category-faq">
    <h2>Hỏi nhanh – đáp gọn</h2>
    <details>
      <summary>Mặc công sở mà vẫn di chuyển công trình được không?</summary>
      <p>Được, dùng áo gió chống nước nhẹ và giày bảo hộ thay nhanh; bên trong giữ set sơ mi + chino để quay lại họp khi cần. <a href="#deals">Xem set đi mưa nhẹ</a>.</p>
    </details>
    <details id="faq-size">
      <summary>Chọn size sao để không phải đổi?</summary>
      <p>Đo Ngực–Eo–Mông bằng thước mềm, so bảng size từng sản phẩm. Giữa hai size: công sở chọn nhỏ, thể thao chọn lớn để thoải mái.</p>
    </details>
    <details>
      <summary>Linen có nóng không?</summary>
      <p>Linen pha (cotton/viscose) thoáng, mát; chấp nhận nếp nhăn tự nhiên, càng mặc càng “đẹp chất”.</p>
    </details>
  </section>

  <!-- HƯỚNG DẪN CHUYÊN SÂU (gói trong accordion để không chắn CTA) -->
  <section class="category-extra">
    <details>
      <summary>Hướng dẫn chuyên sâu: chất liệu, form, bảo quản</summary>

      <!-- MXD-ANCHOR:CATEGORY-INTRO -->
      <div class="category-intro">
        <p><strong>Chất liệu & hiệu năng:</strong> Cotton compact/cotton–spandex thoáng và giãn nhẹ; linen pha cho cuối tuần; polyester (dry–fit) cho vận động; nylon ripstop chống sờn rách khi đi công trình; denim giữ phom lâu năm. Bảo hộ ưu tiên dải phản quang, vải chống UV; thu–đông dùng nỉ, fleece hoặc áo gió chống nước nhẹ.</p>
        <p><strong>Form & phối đồ:</strong> Quy tắc “ôm–vừa–rộng”: áo trong ôm, lớp giữa vừa, outer rộng hơn nửa size để thoáng; bảng màu capsule đen–navy–xám–be, điểm nhấn trắng/olive/camel.</p>
        <p><strong>Bảo quản & size:</strong> Giặt nhẹ ≤30°C, lộn trái đồ in, phơi râm; denim/len giặt ít. Đo Ngực–Eo–Mông và so bảng size từng sản phẩm.</p>
        <ul class="bullets">
          <li><strong>Đi làm:</strong> sơ mi oxford/áo polo + chino, thêm áo gió mỏng khi di chuyển.</li>
          <li><strong>Đi công trình:</strong> áo phản quang, quần túi hộp nylon ripstop, giày mũi thép; mũ bảo hộ đạt chuẩn.</li>
          <li><strong>Cuối tuần:</strong> tee cotton–spandex, jogger, áo khoác chống nắng, mũ lưỡi trai.</li>
        </ul>
      </div>

      <!-- MXD-ANCHOR:CATEGORY-STORY -->
      <div class="category-story">
        <h3>Câu chuyện: một ngày “hai nửa”</h3>
        <p>Buổi sáng họp phòng lạnh, trưa ghé công trình: chỉ cần khoác áo gió chống nước nhẹ, đổi sang giày bảo hộ là “chuyển chế độ” trong 30 giây. Bí quyết là <em>chọn đúng chất liệu và chuẩn bị lớp áo ngoài hợp cảnh</em>.</p>
      </div>

      <!-- MXD-ANCHOR:CATEGORY-FIELDS -->
      <div class="category-fields">
        <h3>Trường đặc biệt</h3>
        <dl>
          <dt>Intent chính</dt><dd>Công sở · Basic hằng ngày · Bảo hộ lao động · Thể thao · Phụ kiện</dd>
          <dt>Chất liệu khuyến nghị</dt><dd>Cotton compact, cotton–spandex, linen pha, polyester (dry–fit), denim, nylon ripstop</dd>
          <dt>Ghi chú form</dt><dd>Ôm–vừa–rộng; outer rộng nửa size để thoáng</dd>
          <dt>Bảo quản</dt><dd>Giặt nhẹ ≤30°C; denim/len giặt ít; đồ thể thao phơi ngay</dd>
        </dl>
      </div>
    </details>
  </section>

  <footer class="page-foot">© MXD · <a href="/chinh-sach/bao-mat.html">Bảo mật</a> · <a href="/chinh-sach/doi-tra.html">Đổi trả</a> · <a href="/chinh-sach/bao-hanh.html">Bảo hành</a></footer>

  <!-- Subnav active -->
  <script>
  (function mxdSubnavActive(){
    try{
      const here = new URL(location.href);
      document.querySelectorAll('.filter-row a.btn').forEach(a=>{
        try{
          const u = new URL(a.getAttribute('href'), location.origin);
          if (u.pathname === here.pathname){ a.classList.add('is-active'); a.setAttribute('aria-current','page'); }
          else { a.classList.remove('is-active'); a.removeAttribute('aria-current'); }
        }catch(_){}
      });
    }catch(_){}
  })();
  </script>

  <!-- CATEGORY META (tuỳ công cụ nội bộ) -->
  <script type="application/json" id="mxd-category-fields">
  {
    "slug": "thoi-trang",
    "primary_intents": ["công sở","basic hằng ngày","bảo hộ lao động","thể thao","phụ kiện"],
    "materials": ["cotton compact","cotton-spandex","linen pha","polyester (dry-fit)","denim","nylon ripstop"]
  }
  </script>

  <!-- RENDERER: affiliates.json → lưới + deals -->
  <script>
  (async function renderMXD(){
    const grid = document.getElementById('product-grid');
    const dealsEl = document.getElementById('deals-grid');

    const cat = (grid.getAttribute('data-category')||'').trim().toLowerCase();
    const aliases = (grid.getAttribute('data-alias')||'').split(',').map(s=>s.trim().toLowerCase()).filter(Boolean);
    const ALIASES = new Set([cat, ...aliases]);

    const sources = ['/assets/data/affiliates.json','/products.json','/affiliates.json'];

    async function loadFirst(urls){
      for (const src of urls){
        try{
          const r = await fetch(src, { cache:'no-store' });
          if (!r.ok) continue;
          const json = await r.json();
          if (Array.isArray(json)) return json;
          if (json && Array.isArray(json.items)) return json.items;
        }catch(e){}
      }
      return null;
    }

    const data = await loadFirst(sources);
    if (!Array.isArray(data)){
      grid.innerHTML = `<p class="muted">Không tải được dữ liệu sản phẩm (đã thử ${sources.join(' → ')}).</p>`;
      return;
    }

    const norm = v => String(v||'').toLowerCase().trim();
    const split = v => norm(v).split(/[,\s/|>]+/).filter(Boolean);
    const toSlug = v => norm(v).replace(/[^a-z0-9\-]+/g,'-').replace(/--+/g,'-');

    function labelsOf(p){
      const labels = [];
      labels.push(...split(p.cat||p.category||p.section||''));
      const m1 = Array.isArray(p.cats)? p.cats : (Array.isArray(p.categories)? p.categories : []);
      labels.push(...m1.flatMap(split));
      if (Array.isArray(p.tags)) labels.push(...p.tags.flatMap(split));
      return Array.from(new Set(labels.map(toSlug).filter(Boolean)));
    }

    const isLive = p => p && p.status !== false && p.status !== 'archived';

    function inCat(p){
      const labels = labelsOf(p);
      if (!labels.length) return false;
      if (labels.some(l => ALIASES.has(l))) return true;
      for (const a of ALIASES){ if (labels.some(l => l.startsWith(a) || a.startsWith(l))) return true; }
      return false;
    }

    const items = data.filter(p => isLive(p) && inCat(p));

    const fmt   = n => (n!=null && isFinite(+n)) ? new Intl.NumberFormat('vi-VN').format(+n)+'₫' : '';
    const esc   = s => String(s||'').replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[c]));
    const href  = p => p.deeplink || p.origin_url || p.origin || p.url || '#';
    const imgOf = p => {
      const sku = (p.sku||'').toLowerCase();
      return p.image || (sku ? `/assets/img/products/${sku}.webp` : '/assets/img/products/placeholder.webp`);
    };

    function cardHTML(p){
      const sku   = (p.sku||'').toLowerCase();
      const name  = p.name || sku || 'Sản phẩm';
      const img   = imgOf(p);
      const price = fmt(p.price);
      const merchant = (p.merchant||'').toLowerCase();
      const link  = href(p);
      const broken = !/^https?:\/\//.test(link);
      return `
        <article class="product-card" data-sku="${esc(sku)}" ${broken?'data-broken="link"':''}>
          <a class="thumb" href="/g.html?sku=${encodeURIComponent(sku)}">
            <img loading="lazy" src="${esc(img)}" alt="${esc(name)} — MXD" width="320" height="320"
                 onerror="this.onerror=null;this.dataset.err=1;this.src='/assets/img/products/placeholder.webp';this.closest('article').setAttribute('data-img-missing','1')">
          </a>
          <h3 class="name"><a href="/g.html?sku=${encodeURIComponent(sku)}">${esc(name)}</a></h3>
          ${price?`<div class="price">${price}</div>`:''}
          <div class="actions">
            <a class="buy buy-btn" href="${esc(link)}" data-merchant="${esc(merchant)}"
               target="_blank" rel="nofollow sponsored noopener">Mua ngay</a>
          </div>
        </article>`;
    }

    if (!items.length){
      grid.innerHTML = `<p class="muted">Chưa có sản phẩm cho danh mục này. Hãy nạp dữ liệu vào <code>/assets/data/affiliates.json</code>.</p>`;
      return;
    }

    grid.innerHTML = items.map(cardHTML).join('');
    grid.querySelectorAll('article.product-card[data-broken], article.product-card[data-img-missing="1"]').forEach(el=>{ el.style.display='none'; });

    // DEALS
    if (dealsEl){
      const isDeal = p => {
        const t = Array.isArray(p.tags)? p.tags.map(norm) : [];
        const flag = (p.deal===true) || t.includes('deal') || t.includes('flash-sale') || t.includes('sale') || t.includes('giam-gia') || t.includes('hot');
        const oldPrice = p.old_price || p.price_old || p.list_price || p.msrp || p.regular_price;
        return flag || (oldPrice && +oldPrice > +p.price);
      };
      const deals = items.filter(isDeal).slice(0,8);
      const list = (deals.length ? deals : items.slice(0,8)).map(cardHTML).join('');
      dealsEl.innerHTML = list;
    }

    // Rewrite affiliate
    if (window.mxdAffiliate?.scan) window.mxdAffiliate.scan();

    // GA4: track mở FAQ (nếu có)
    try{
      document.querySelectorAll('.category-faq details').forEach(d=>{
        d.addEventListener('toggle', ()=>{
          if (d.open && window.gtag){
            const q = d.querySelector('summary')?.textContent?.trim() || 'faq';
            gtag('event','faq_open',{category:'fashion',label:q});
          }
        });
      });
    }catch(_){}
  })();
  </script>

  <!-- FAQPage JSON-LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"Mặc công sở mà vẫn di chuyển công trình được không?","acceptedAnswer":{"@type":"Answer","text":"Được, dùng áo gió chống nước nhẹ và giày bảo hộ thay nhanh; bên trong giữ set sơ mi + chino để quay lại họp khi cần."}},
      {"@type":"Question","name":"Chọn size sao để không phải đổi?","acceptedAnswer":{"@type":"Answer","text":"Đo Ngực–Eo–Mông bằng thước mềm và so bảng size từng sản phẩm. Giữa hai size: công sở chọn nhỏ, thể thao chọn lớn."}},
      {"@type":"Question","name":"Linen có nóng không?","acceptedAnswer":{"@type":"Answer","text":"Linen pha (cotton/viscose) thoáng mát; chấp nhận nếp nhăn tự nhiên, càng mặc càng đẹp chất."}}
    ]
  }
  </script>
</body>
</html>
